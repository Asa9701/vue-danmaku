!function(n,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e=t();for(var i in e)("object"==typeof exports?exports:n)[i]=e[i]}}("undefined"!=typeof self?self:this,function(){return function(n){function t(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return n[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var e={};return t.m=n,t.c=e,t.d=function(n,e,i){t.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:i})},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="/dist/",t(t.s=1)}([function(n,t,e){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.a={props:{danmus:{type:Array,required:!0},config:{type:Object,default:function(){return{}}}},data:function(){return{container:null,isActive:!1,timer:null,$danmaku:null,$danmus:null,danmaku:{danmus:[],width:0,channels:0,loop:!1},danmu:{height:30,fontSize:18,speed:5},hidden:!1,paused:!1,index:0,continue:!0,danChannel:{}}},computed:{},watch:{},created:function(){},mounted:function(){var n=this;this.$nextTick(function(){n.init(),n.$emit("inited")})},methods:{init:function(){this.initCore(),this.initConfig()},reset:function(){this.initConfig()},mouseIn:function(){this.$emit("mouseIn")},mouseOut:function(){this.$emit("mouseOut")},initCore:function(){this.$danmaku=this.$refs.danmaku,this.$danmus=this.$refs.danmus},initConfig:function(){this.danmaku.width=this.$danmaku.offsetWidth,this.danmaku.height=this.$danmaku.offsetHeight,this.danmaku.danmus=this.danmus,this.danmaku.channels=this.config.channels||parseInt(this.danmaku.height/this.danmu.height),this.danmaku.loop=this.config.loop||this.danmaku.loop,this.danmu.speed=this.config.speed||this.danmu.speed,this.danmu.fontSize=this.config.fontSize||this.danmu.fontSize},play:function(){if(this.paused)return void(this.paused=!1);this.timer||this.draw()},draw:function(){var n=this;this.$nextTick(function(){n.timer=setInterval(function(){n.index>n.danmus.length-1?n.config.loop?n.insert():n.clear():n.insert()},50)})},insert:function(){var n=this,t=this.config.loop?this.index%this.danmus.length:this.index,e=document.createElement("p");this.continue&&(e.classList.add("move"),e.style.animationDuration=this.danmu.speed+"s",e.style.fontSize=this.danmu.fontSize+"px",e.innerHTML=this.danmus[t],e.setAttribute("index",this.index),this.$danmus.appendChild(e)),this.$nextTick(function(){var t=n.getChannel(e);if(t>=0){n.continue=!0;var i=e.offsetWidth,a=n.danmu.height>n.danmu.fontSize?n.danmu.height:n.danmu.fontSize+4;e.classList.add("dm"),e.style.top=t*a+"px",e.style.width=i+1+"px",e.style.transform="translateX(-"+n.danmaku.width+"px)",e.addEventListener("animationend",function(){n.$danmus.removeChild(e)}),e.classList.length>0&&n.index++}else e.classList.length>0&&n.$danmus.removeChild(e)})},getChannel:function(n){for(var t=this,e=this.$danmus.offsetWidth/((this.$danmus.offsetWidth+n.offsetWidth)/6),a=0;a<this.danmaku.channels;a++){var s=function(i){var a=t.danChannel[i+""];if(!a||!a.length)return t.danChannel[i+""]=[n],n.addEventListener("animationend",function(){t.danChannel[i+""].splice(0,1)}),{v:i%t.danmaku.channels};for(var s=0;s<a.length;s++){var o=t.getDanRight(a[s])-10;if(o<=t.$danmus.offsetWidth-e*((t.$danmus.offsetWidth+parseInt(a[s].offsetWidth))/6)||o<=0)break;if(s===a.length-1)return t.danChannel[i+""].push(n),n.addEventListener("animationend",function(){t.danChannel[i+""].splice(0,1)}),{v:i%t.danmaku.channels}}}(a);if("object"===(void 0===s?"undefined":i(s)))return s.v}return-1},getDanRight:function(n){var t=n.offsetWidth||parseInt(n.style.width),e=n.getBoundingClientRect().right||this.$danmus.getBoundingClientRect().right+t;return this.$danmus.getBoundingClientRect().right-e},add:function(n){var t=this.index%this.danmaku.danmus.length;this.danmaku.danmus.splice(t,0,n)},pause:function(){this.paused=!0},stop:function(){this.danChannel={},this.$refs.danmus.innerHTML="",this.paused=!1,this.hidden=!1,this.clear()},clear:function(){clearInterval(this.timer),this.timer=null,this.index=0},show:function(){this.hidden=!1},hide:function(){this.hidden=!0},resize:function(){this.initConfig();for(var n=this.$danmaku.getElementsByClassName("dm"),t=0;t<n.length;t++)n[t].style.transform="translateX(-"+this.danmaku.width+"px)"}}}},function(n,t,e){n.exports=e(2)},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e(3);i.a.install=function(n){n.component("VueDanmaku",i.a)},t.default=i.a},function(n,t,e){"use strict";function i(n){e(4)}var a=e(0),s=e(10),o=e(9),r=i,u=o(a.a,s.a,!1,r,null,null);t.a=u.exports},function(n,t,e){var i=e(5);"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);e(7)("c6118280",i,!0,{})},function(n,t,e){t=n.exports=e(6)(!1),t.push([n.i,".vue-danmaku{position:relative;overflow:hidden}.vue-danmaku .danmus{position:absolute;left:0;top:0;width:100%;height:100%;opacity:0;-webkit-transition:all .3s;transition:all .3s}.vue-danmaku .danmus.show{opacity:1}.vue-danmaku .danmus.paused .dm.move{animation-play-state:paused}.vue-danmaku .danmus p{position:absolute;color:#fff;text-shadow:1px 1px 1px #000;margin:0;white-space:pre}.vue-danmaku .danmus .dm{position:absolute;color:#fff;font-size:18px;right:0;top:8px;white-space:pre;text-shadow:1px 1px 2px #001;transform:translateX(100%)}.vue-danmaku .danmus .dm.move{will-change:transform;animation-name:danmaku;animation-timing-function:linear;animation-play-state:running}@keyframes danmaku{0%{transform:translateX(100%)}}@-webkit-keyframes danmaku{0%{-webkit-transform:translateX(100%)}}",""])},function(n,t){function e(n,t){var e=n[1]||"",a=n[3];if(!a)return e;if(t&&"function"==typeof btoa){var s=i(a);return[e].concat(a.sources.map(function(n){return"/*# sourceURL="+a.sourceRoot+n+" */"})).concat([s]).join("\n")}return[e].join("\n")}function i(n){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"}n.exports=function(n){var t=[];return t.toString=function(){return this.map(function(t){var i=e(t,n);return t[2]?"@media "+t[2]+"{"+i+"}":i}).join("")},t.i=function(n,e){"string"==typeof n&&(n=[[null,n,""]]);for(var i={},a=0;a<this.length;a++){var s=this[a][0];"number"==typeof s&&(i[s]=!0)}for(a=0;a<n.length;a++){var o=n[a];"number"==typeof o[0]&&i[o[0]]||(e&&!o[2]?o[2]=e:e&&(o[2]="("+o[2]+") and ("+e+")"),t.push(o))}},t}},function(n,t,e){function i(n){for(var t=0;t<n.length;t++){var e=n[t],i=f[e.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](e.parts[a]);for(;a<e.parts.length;a++)i.parts.push(s(e.parts[a]));i.parts.length>e.parts.length&&(i.parts.length=e.parts.length)}else{for(var o=[],a=0;a<e.parts.length;a++)o.push(s(e.parts[a]));f[e.id]={id:e.id,refs:1,parts:o}}}}function a(){var n=document.createElement("style");return n.type="text/css",c.appendChild(n),n}function s(n){var t,e,i=document.querySelector("style["+g+'~="'+n.id+'"]');if(i){if(p)return m;i.parentNode.removeChild(i)}if(y){var s=h++;i=l||(l=a()),t=o.bind(null,i,s,!1),e=o.bind(null,i,s,!0)}else i=a(),t=r.bind(null,i),e=function(){i.parentNode.removeChild(i)};return t(n),function(i){if(i){if(i.css===n.css&&i.media===n.media&&i.sourceMap===n.sourceMap)return;t(n=i)}else e()}}function o(n,t,e,i){var a=e?"":i.css;if(n.styleSheet)n.styleSheet.cssText=x(t,a);else{var s=document.createTextNode(a),o=n.childNodes;o[t]&&n.removeChild(o[t]),o.length?n.insertBefore(s,o[t]):n.appendChild(s)}}function r(n,t){var e=t.css,i=t.media,a=t.sourceMap;if(i&&n.setAttribute("media",i),v.ssrId&&n.setAttribute(g,t.id),a&&(e+="\n/*# sourceURL="+a.sources[0]+" */",e+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}var u="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!u)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var d=e(8),f={},c=u&&(document.head||document.getElementsByTagName("head")[0]),l=null,h=0,p=!1,m=function(){},v=null,g="data-vue-ssr-id",y="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());n.exports=function(n,t,e,a){p=e,v=a||{};var s=d(n,t);return i(s),function(t){for(var e=[],a=0;a<s.length;a++){var o=s[a],r=f[o.id];r.refs--,e.push(r)}t?(s=d(n,t),i(s)):s=[];for(var a=0;a<e.length;a++){var r=e[a];if(0===r.refs){for(var u=0;u<r.parts.length;u++)r.parts[u]();delete f[r.id]}}}};var x=function(){var n=[];return function(t,e){return n[t]=e,n.filter(Boolean).join("\n")}}()},function(n,t){n.exports=function(n,t){for(var e=[],i={},a=0;a<t.length;a++){var s=t[a],o=s[0],r=s[1],u=s[2],d=s[3],f={id:n+":"+a,css:r,media:u,sourceMap:d};i[o]?i[o].parts.push(f):e.push(i[o]={id:o,parts:[f]})}return e}},function(n,t){n.exports=function(n,t,e,i,a,s){var o,r=n=n||{},u=typeof n.default;"object"!==u&&"function"!==u||(o=n,r=n.default);var d="function"==typeof r?r.options:r;t&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0),e&&(d.functional=!0),a&&(d._scopeId=a);var f;if(s?(f=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,n||"undefined"==typeof __VUE_SSR_CONTEXT__||(n=__VUE_SSR_CONTEXT__),i&&i.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(s)},d._ssrRegister=f):i&&(f=i),f){var c=d.functional,l=c?d.render:d.beforeCreate;c?(d._injectStyles=f,d.render=function(n,t){return f.call(t),l(n,t)}):d.beforeCreate=l?[].concat(l,f):[f]}return{esModule:o,exports:r,options:d}}},function(n,t,e){"use strict";var i=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{ref:"danmaku",staticClass:"vue-danmaku",on:{mouseenter:n.mouseIn,mouseleave:n.mouseOut}},[n._t("default"),n._v(" "),e("div",{ref:"danmus",class:["danmus",{show:!n.hidden},{paused:n.paused}]})],2)},a=[],s={render:i,staticRenderFns:a};t.a=s}]).default});
//# sourceMappingURL=vue-danmaku.js.map